const express = require(\"express\");\nconst verifyRefreshToken = require(\"../middlewares/verifyRefreshToken\");\nconst generateTokens = require(\"../utils/generateTokens\");\nconst cookieConfig = require(\"../configs/cookieConfig\");\n\nconst tokensRouter = express.Router();\n\ntokensRouter.get(\"/refresh\", verifyRefreshToken, async (req, res) => {\n  try {\n    const { accessToken, refreshToken } = generateTokens({\n      user: res.locals.user,\n    });\n\n    // Обновляем токены и отправляем ответ клиенту\n    res\n      .cookie(\"refreshToken\", refreshToken, cookieConfig)\n      .json({ accessToken, user: res.locals.user });\n  } catch (error) {\n    console.error(\"Token refresh error:\", error.message);\n    res.clearCookie(\"refreshToken\", cookieConfig).status(401).json({\n      error: \"Authentication failed\",\n      message: \"Failed to refresh token. Please login again.\"\n    });\n  }\n});\n\nmodule.exports = tokensRouter;\n